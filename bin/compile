#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir>

set -e
set -o pipefail

BUILD_DIR=$1
CACHE_DIR=$2

mkdir vendor
cd vendor
wget https://cmake.org/files/v3.11/cmake-3.11.1.tar.gz
tar -xvf cmake-3.11.1.tar.gz
cd cmake-3.11.1
./configure
sudo make install

cd $BUILD_DIR

# configure
#if [ -f $1/prepare.py ]; then
#  echo "-----> Configuring"
#  ./prepare.py
#fi

# make
echo "-----> Compiling with Make"
make -C WORK/flexisip/cmake
